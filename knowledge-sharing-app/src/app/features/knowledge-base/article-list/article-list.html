<div class="article-list-container">
  <!-- Header Section -->
  <div class="list-header">
    <div class="header-content">
      <h1>Knowledge Base</h1>
      <p>Discover and explore our shared knowledge repository</p>
    </div>
    
    @if (canCreateArticles()) {
      <div class="header-actions">
        <button mat-raised-button 
                color="primary" 
                routerLink="/knowledge/create"
                matTooltip="Create New Article">
          <mat-icon>add</mat-icon>
          Create Article
        </button>
      </div>
    }
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading articles...</p>
    </div>
  }

  <!-- Articles Grid -->
  @if (!isLoading() && paginatedArticles().length > 0) {
    <div class="articles-grid">
      @for (article of paginatedArticles(); track article.id) {
        <mat-card class="article-card">
          <div class="article-image">
            <img [src]="getImageUrl(article) || getPlaceholderImage(article.categoryId)" 
                 [alt]="article.title"
                 (error)="onImageError($event)"
                 loading="lazy">
          </div>
          
          <mat-card-header>
            <mat-card-title>{{ article.title }}</mat-card-title>
            <mat-card-subtitle>
              <span class="category-badge">{{ getCategoryName(article.categoryId) }}</span>
              <span class="date">{{ formatDate(article.createdAt) }}</span>
            </mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <p class="article-preview">{{ article.excerpt || getArticlePreview(article.content) }}</p>
            
            @if (article.tags.length > 0) {
              <div class="tags-container">
                <mat-chip-set>
                  @for (tag of article.tags; track tag) {
                    <mat-chip>{{ tag }}</mat-chip>
                  }
                </mat-chip-set>
              </div>
            }
          </mat-card-content>

          <mat-card-actions align="end">
            <button mat-button 
                    color="primary"
                    [routerLink]="['/knowledge', article.id]">
              <mat-icon>visibility</mat-icon>
              Read More
            </button>
            
            @if (canCreateArticles()) {
              <button mat-button 
                      color="accent"
                      [routerLink]="['/knowledge/edit', article.id]">
                <mat-icon>edit</mat-icon>
                Edit
              </button>
            }
          </mat-card-actions>
        </mat-card>
      }
    </div>

    <!-- Pagination -->
    <mat-paginator 
      [length]="totalArticles()"
      [pageSize]="pageSize()"
      [pageIndex]="currentPage()"
      [pageSizeOptions]="[5, 10, 20, 50]"
      (page)="onPageChange($event)"
      aria-label="Select page">
    </mat-paginator>
  }

  <!-- Empty State -->
  @if (!isLoading() && paginatedArticles().length === 0) {
    <div class="empty-state">
      <mat-icon class="empty-icon">library_books</mat-icon>
      <h2>No Articles Found</h2>
      <p>There are no published articles yet.</p>
      
      @if (canCreateArticles()) {
        <button mat-raised-button 
                color="primary" 
                routerLink="/knowledge/create">
          <mat-icon>add</mat-icon>
          Create First Article
        </button>
      }
    </div>
  }
</div>
